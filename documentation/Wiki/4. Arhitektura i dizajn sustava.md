# Arhitektura sustava

## Opis arhitekture
Arhitektura sustava koristi klijent-poslužitelj model organiziran u tri glavna sloja:

* **Web preglednik (klijent):** Web preglednik služi kao korisničko sučelje za interakciju s aplikacijom. Putem web preglednika korisnik pokreće zahtjeve i šalje podatke poslužitelju te prima i obrađuje odgovore za prikaz traženih informacija. Web preglednik također obrađuje HTML, CSS i JavaScript sadržaj te osigurava ispravno prikazivanje elemenata korisničkog sučelja.

* **Web poslužitelj (backend):** Web poslužitelj djeluje posrednik između klijenta i baze podataka te je odgovoran za obradu dolaznih zahtjeva i slanje odgovora natrag klijentu. Komunikacija se odvija putem RESTful API-ja koristeći HTTP protokol. Ovisno o vrsti zahtjeva web poslužitelj ili dohvaća podatke iz baze podataka ili pohranjuje podatke koje je poslao klijent.

* **Baza podataka:** Baza podataka je glavni sloj za pohranu svih podataka aplikacije. U njoj se čuvaju trajni podaci poput korisničkih informacija te sadržaja i postavki aplikacije. Skoro svi zahtjevi kojima upravlja web poslužitelj uključuju komunikaciju s bazom podataka za čitanje ili pohranjivanje informacija.

## Obrazloženje odabira arhitekture
Stil klijent-poslužitelj s RESTful API-jem odabran je zbog sljedećih prednosti:

**1. Razdvajanje problema:** Klijentska i poslužiteljska strana razvijaju se i održavaju razdvojeno i neovisno jedna o drugoj, što omogućuje učinkovito upravljanje resursima.

**2. Učinkovito rukovanje podacima:** Poslužiteljska strana je pružatelj podataka, dok klijentska strana brine o API-jevima

## Organizacija sustava na visokoj razini
Sustav je organiziran u tri funkcionalno odvojena dijela koji međusobno komuniciraju putem API-ja:

* **Klijent (React aplikacija):** šalje zahtjeve prema poslužitelju

* **Backend (Spring Boot aplikacija):** obrađuje zahtjeve s klijenta i komunicira s bazom

* **Baza podataka:** pohranjuje i vraća podatke koje koristi poslužitelj

## Organizacija aplikacije
* **Poslužiteljski dio:** Ostvaren programskim jezikom Java pomoću alata Spring-Boot radnog okvira. Razvija se u razvojnom okruženju IntelliJ IDEA, koje podržava Spring-Boot alate.

* **Klijentski dio:** Ostvaren programskim jezikom JavaScript pomoću React radnog okvira. Razvija se u razvojnom okruženju WebStorm.

* **Dizajn korisničkog sučelja:** Ostvaren pomoću alata Figma.

Sva razvojna okruženja razvijena su od strane JETBrains-a radi konzistentnosti.

# Baza podataka

## Opis tablica
### Drzava

Predstavlja zemlju porijekla mjesta. Atributi: drzava_id (PK), nazivDrzave (U).

| Atribut     | Tip podatka | Opis varijable                         |
|-------------|-------------|----------------------------------------|
| drzava_id   | SERIAL      | Jedinstveni indetifikator svake države |
| nazivDrzave | VARCHAR(50) | Jedinstveni naziv države               |

### Mjesto

Predstavlja mjesto iz kojeg je korisnik aplikacije. Tablica je povezana: Many-to-One s Drzava preko drzava_id. Atributi: postBr (PK), nazMjesto, drzava_id (FK).

| Atribut   | Tip podatka | Opis varijable                          |
|-----------|-------------|-----------------------------------------|
| id        | SERIAL      | jedinstveni identifikator svakog mjesta |
| postBr    | VARCHAR(20) | Jedinstveni poštanski broj mjesta       |
| nazMjesto | VARCHAR(50) | Naziv mjesta                            |
| drzava_id | INTEGER     | Identifikator države                    |

### Korisnik

Predstavlja korisnika aplikacije, uključujući goste i zaposlenike. Sadrži osobne podatke poput imena, email-a, telefonskog broja te njihove uloge u aplikaciji. Tablica je povezana: Many-to-One s Mjesto preko postBr te One-to-Many s Upit, Rezervacija i Recenzija preko korisnik_id. Atributi: korisnik_id (PK), imeKorisnik, prezimeKorisnik, emailKorisnik (U), telefonKorisnik (U), ovlastKorisnik, postBR (FK).

| Atribut         | Tip podatka | Opis varijable                             |
|-----------------|-------------|--------------------------------------------|
| korisnik_id     | SERIAL      | Jedinstveni identifikator svakog korisnika |
| imeKorisnik     | VARCHAR(50) | Ime korisnika                              |
| prezimeKorisnik | VARCHAR(50) | Prezime korisnika                          |
| emailKorisnik   | VARCHAR(50) | Jedinstveni email korisnika                |
| telefonKorisnik | VARCHAR(20) | Jedinstveni telefonski broj korisnika      |
| ovlastKorisnik  | VARCHAR(20) | Ovlast korisnika u aplikaciji              |
| mjesto_id       | INTEGER     | Identifikator mjesta odakle je korisnik    |

### Soba

Predstavlja sobu hotela. Sadrži podatke poput vrste sobe, cijene i dostupnosti. Tablica je povezana: One-to-Many s RezervirajSobu preko broj_sobe. Atributi: broj_sobe (PK), vrsta, cijena, status.

| Atribut        | Tip podatka | Opis varijable                               |
|----------------|-------------|----------------------------------------------|
| soba_id        | SERIAL      | Jedinstveni identifikator svake sobe         |
| broj_sobe      | VARCHAR(5)  | Jedinstveni broj svake sobe                  |
| vrsta          | VARCHAR(20) | Vrsta sobe                                   |
| cijena         | INTEGER     | Cijena sobe                                  |
| status         | VARCHAR(20) | Status sobe, je li soba slobodna ili zauzeta |
| kapacitet      | INTEGER     | Ne null element koji označava kapacitet sobe |
| balkon         | BOOLEAN     | opisuje sadrzi li soba balkon                |
| pogled_na_more | BOOLEAN     | opisuje sadryi li soba pogled_na_more        |

### Rezervacija

Predstavlja rezervaciju. Tablica je povezana: Many-to-One s Korisnik preko korisnik_id te One-to-Many s Plaćanje, RezervirajSobu i RezervirajSadrzaj preko rezervacija_id. Atributi: rezervacija_id (PK), datumRezerviranja, placeno?, korisnik_id (FK).

| Atribut           | Tip podatka   | Opis varijable                                       |
|-------------------|---------------|------------------------------------------------------|
| rezervacija_id    | SERIAL        | Jedinstveni identifikator svake rezervacije          |
| datumRezerviranja | DATE          | Datum rezervacije                                    |
| placeno           | BOOLEAN       | Je li rezervacija plaćena ili nije                   |
| iznos_rezervacije | NUMERIC(10,2) | cijena rezervacije                                   |
| korisnik_id       | INTEGER       | Identifikator korisnika koji je napravio rezervaciju |

### DodatniSadrzaj

Predstavlja dodatni sadržaj hotela koji se može rezervirati. Sadrži podatke poput: vrsta, cijena, dostupnost i kapacitet dodatnog sadržaja. Tablica je povezana: One-to-Many s RezervirajSadrzaj preko dodatniSadrzaj_id. Atributi: dodatniSadrzaj_id (PK), vrstaDodatniSadrzaj, statusDodatniSadrzaj, cijenaDOdatniSadrzaj, kapacitetDodatniSadrzaj.

| Atribut                 | Tip podatka   | Opis varijable                                                    |
|-------------------------|---------------|-------------------------------------------------------------------|
| dodatniSadrzaj_id       | SERIAL        | Jedinstveni identifikator svakog dodatnog sadržaja                |
| vrstaDodatniSadrzaj     | VARCHAR(20)   | Vrsta dodatnog sadržaja                                           |
| cijena_sadrzaj          | NUMERIC(10,2) | Cijena sobe                                                       |
| statusDodatniSadrzaj    | VARCHAR(20)   | Status dodatnog sadržaja, je li dodatan sadržaj dostupan ili nije |

### Recenzija

Predstavlja recnziju koju gost holela može ostaviti. Tablica je povezana: Many-to-One s Korisnik preko korisnik_id. Atributi: recenzija_id (PK), ocjenaRecenzija, komentarRecenzija, datumRecenzija, korisnik_id (FK).

| Atribut           | Tip podatka | Opis varijable                                    |
|-------------------|-------------|---------------------------------------------------|
| recenzija_id      | SERIAL      | Jedinstveni identifikator svake recenzije         |
| ocjenaRecenzija   | INTEGER     | Ocjena dana u recenziji                           |
| komentarRecenzija | TEXT        | Komentar dan u recenziji                          |
| datumRecenzija    | DATE        | Datum recenzije                                   |
| korisnik_id       | INTEGER     | Identifikator korisnika koji je ostavio recenziju |

### RezervirajSadrzaj

Predstavlja rezervaciju dodatnog sadržaja hotela. Tablica je povezana: Many-to-One s Rezervacija preko rezervacija_id i One-to-Many s DodatniSadrzaj preko dodatniSadrzaj_id. Atributi: rezervacija_id (FK), dodatniSadrzaj_id (FK), datumOdSadrzaj, datumDoSadrzaj. Ključ tablice je par (rezervacija_id, dodatniSadrzaj_id).

| Atribut           | Tip podatka | Opis varijable                                         |
|-------------------|-------------|--------------------------------------------------------|
| rezervacija_id    | INTEGER     | Identifikator rezervacije                              |
| dodatniSadrzaj_id | INTEGER     | Identifikator dodatnog sadržaja koji će se rezervirati |
| datum_sadrzaj     | DATE        | Datum rezervacije dodatnog sadržaja                    |

### RezervirajSobu

Predstavlja rezervaciju sobe hotela. Tablica je povezana: Many-to-One s Rezervacija preko rezervacija_id i One-to-Many s Soba preko broj_sobe. Atributi: rezervacija_id (FK), broj_sobe (FK), datumOdSoba, datumDoSoba. Ključ tablice je par (rezervacija_id, broj_sobe).

| Atribut        | Tip podatka | Opis varijable                   |
|----------------|-------------|----------------------------------|
| rezervacija_id | INTEGER     | Identifikator rezervacije        |
| soba_id        | INTEGER     | Identifikator sobe               |
| datumOdSoba    | DATE        | Datum početka rezervacije sobe   |
| datumDoSoba    | DATE        | Datum završetka rezervacije sobe |

## Dijagram baze podataka
<img width="900" src="https://github.com/rokoKnin/ProgiG03.3_JuliusMeinl/blob/main/documentation/images/baza_final.png" />

# Dijagram razreda


Na slikama 4.1 – 4.4 prikazani su dijagrami razreda razdvojeni po paketima unutar backend (Spring Java) i frontend (React) dijela aplikacije. Radi preglednosti, dijagrami su razlomljeni po slojevima, a zatim je prikazan integrirani dijagram koji povezuje frontend i backend slojeve.


### Model / Entities (Backend)


Slika 4.1 prikazuje entitete koji predstavljaju tablice baze podataka. Klase unutar **model paketa** sadrže atribute koji se mapiraju na stupce baze i prikazuju relacije između entiteta.

- Klase sadrže osnovne metode za dodavanje i uklanjanje povezanih objekata (npr. `Korisnik.addRezervacija()`).
- Embeddable klase (`RezervirajSobuId`, `RezervirajSadrzajId`) koriste se za složene primarne ključeve.
- Enumeracije (`UlogaKorisnika`, `StatusSobe`) definiraju fiksni skup vrijednosti za atribute korisnika i soba.
- Relacije između entiteta prikazane su strelicama s opisom (npr. `makes`, `reserves`).

<img width="900" height="800" alt="Screenshot 2025-11-10 105611" src="https://github.com/user-attachments/assets/c5b89130-e13d-45fa-b6f7-d74b529fc9b4" />

*Slika 4.1 – Dijagram entiteta (Model / Entities)*

### Backend slojevi (Repository / Service / Controller / Config)

Slika 4.2 prikazuje klase unutar **repository, service i controller paketa**.

- **Repository paketi** sadrže sučelja (`KorisnikRepository`) koja olakšavaju CRUD operacije nad bazom.
- **Service paketi** implementiraju poslovnu logiku, npr. `KorisnikService` i `KorisnikServiceJpa`  upravljaju pozivima repozitorija i mapiranjem podataka.
- **Controller paketi** (`KorisnikController`) definiraju REST krajnje točke i obrađuju HTTP zahtjeve.
- **Config paketi** sadrže sigurnosne konfiguracije i servise za OAuth2 servise (`CustomOAuth2UserService`,`SecurityConfig`).


<img width="1100" height="450" alt="Screenshot 2025-11-10 105844" src="https://github.com/user-attachments/assets/85615776-f9bf-4c41-8f83-5eac894122f3" />

*Slika 4.2 – Backend slojevi (Repository / Service / Controller / Config)*
###  Frontend (React)

Slika 4.3 prikazuje glavne **stranice i komponente React aplikacije**.

- **Pages / Views**: `HomePage`, `LogIn`, `About`, `Contact`, `ReservationSlider` – stranice koje prikazuju sadržaj korisniku.
- **Components**: `Header`, `CustomMap`, `Reservation`, `HorizontalLinearStepper`, `Modal`, `NumberInput` – komponente koje se višekratno koriste unutar stranica.
- **App / Router**: `App` komponenta koja koristi React Router za navigaciju između stranica.
- Strelice prikazuju hijerarhiju komponenti i tok navigacije korisnika.


<img width="800" height="500" alt="Screenshot 2025-11-10 110447" src="https://github.com/user-attachments/assets/02ea14cc-8c19-4315-a4e4-197c0852b39e" />

*Slika 4.3 – Frontend React komponente*

###  Integrirani dijagram slojeva (Frontend → Backend)

Slika 4.4 prikazuje **integrirani dijagram koji povezuje frontend i backend slojeve**.

- Frontend komponente i stranice prikazane su u gornjem dijelu, backend paketi u donjem.
- Strelice označavaju REST pozive i tok podataka:
    - `ReservationSlider` i `HorizontalLinearStepper` komuniciraju s `KorisnikController` za CRUD operacije rezervacija.
    - `LogIn` komponenta poziva backend za autentifikaciju korisnika.
    - `Contact` komponenta šalje zahtjeve prema `RestController` za prikaz poruke dobrodošlice.

<img width="800" height="650" alt="Screenshot 2025-11-10 110655" src="https://github.com/user-attachments/assets/39bae446-0f01-4903-b144-483982eb6665" />

*Slika 4.4 – Integrirani dijagram (Frontend → Backend)*
# Dinamičko ponašanje aplikacije

## UML dijagrami stanja

Dijagram stanja prikazuje dinamičko ponašanje aplikacije iz perspektive korisnika, odnosno prijelaze između različitih stanja sustava tijekom tipičnih korisničkih aktivnosti kao što su autentifikacija, uređivanje profila, slanje upita, rezervacija sobe i dodatnog sadržaja, plaćanje te ostavljanje recenzije.

![Dijagram stanja](https://github.com/user-attachments/assets/cb65eeeb-fb99-4bb8-822f-b30827261ce5)
*Slika 4.5 - Dijagram stanja*


Proces započinje početnim stanjem u kojem korisnik može pokrenuti prijavu u sustav. Tijekom autentifikacije sustav može prijeći u stanje uspješne ili neuspješne autentifikacije, pri čemu se u slučaju pogreške korisniku omogućuje ponovni pokušaj prijave. Nakon uspješne prijave korisnik dolazi na stranicu profila, gdje može pregledavati i uređivati svoje podatke.

Iz glavnog stanja aplikacije korisnik može odabrati više funkcionalnosti:

* Slanje upita putem kontakt forme, gdje sustav obrađuje upit i vraća informaciju o uspješnom ili neuspješnom slanju.

* Rezervaciju sobe, koja uključuje odabir sobe i prelazak u stanje odabrane sobe.

* Rezervaciju dodatnog sadržaja, gdje korisnik bira dodatne usluge koje se vežu uz rezervaciju.

* Plaćanje rezervacije, koje prolazi kroz stanja iniciranja i obrade plaćanja te završava uspješnom ili neuspješnom transakcijom.

* Ocjenjivanje usluge, gdje korisnik ostavlja recenziju, a sustav potvrđuje uspješno zaprimanje ocjene ili javlja pogrešku.

Ovim dijagramom obuhvaćeni su ključni poslovni procesi aplikacije te je vizualno prikazan način na koji sustav reagira na korisničke akcije i upravlja prijelazima između stanja tijekom rada aplikacije.


## UML dijagrami aktivnosti

Dijagram aktivnosti prikazuje proces rezervacije hotelske sobe s odabirom dodatnog sadržaja i provedbom plaćanja.
Aktori uključeni u proces su korisnik, web aplikacija i baza podataka.


![UML dijagram aktivnosti](https://github.com/user-attachments/assets/75655b74-027a-47e8-9814-65c59996118b)


*Slika 4.6 - Dijagram aktivnosti*

Interakcija između sudionika odvija se kroz sljedeće korake:

1. Korisnik pokreće pretragu soba te u web aplikaciji unosi kriterije pretrage (datum boravka, broj gostiju i broj soba).

2. Web aplikacija provjerava dostupnost soba te dohvaća filtrirane podatke iz baze podataka, nakon čega korisniku prikazuje rezultate pretrage.

3. Korisnik odabire željenu sobu te po potrebi dodaje dodatni sadržaj (bazen, restoran, teretana).

4. Nakon potvrde rezervacije, web aplikacija izračunava ukupnu cijenu na temelju odabrane sobe i dodatnog sadržaja.

5. Korisnik odabire način plaćanja i unosi potrebne podatke za plaćanje, dok web aplikacija obrađuje plaćanje.

6. U slučaju neuspješnog plaćanja, korisniku se omogućuje ponovni unos podataka za plaćanje.

7. U slučaju uspješnog plaćanja, web aplikacija zahtijeva spremanje rezervacije, a baza podataka pohranjuje podatke o rezervaciji.

8. Nakon uspješnog spremanja rezervacije, web aplikacija korisniku šalje e-mail s detaljima rezervacije, koji korisnik zaprima kao potvrdu uspješne rezervacije.